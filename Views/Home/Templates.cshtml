
@using StockGTO.Models
@{
    ViewData["Title"] = "模板總覽";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var templateFolders = ViewBag.TemplateFolders as List<TemplateViewModel>;
}

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 class="mt-5">模板總覽</h1>

@if (templateFolders != null && templateFolders.Any())
{
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        @foreach (var item in templateFolders)
        {
            var previewUrl = $"/templates/{item.FolderName}/index.html";


            // 正確 Razor 寫法（不用多加 @{} 區塊）
            var folderDir = System.IO.Path.Combine(Directory.GetCurrentDirectory(), "wwwroot", "templates", item.FolderName);
            var ssPath = System.IO.Path.Combine(folderDir, "screenshot.png");
            var prevPath = System.IO.Path.Combine(folderDir, "preview.jpg");


            string imageUrl = System.IO.File.Exists(ssPath)
            ? $"/templates/{item.FolderName}/screenshot.png"
            : System.IO.File.Exists(prevPath)
            ? $"/templates/{item.FolderName}/preview.jpg"
            : "/images/no-preview.png";







            <div class="col">
                <div class="card h-100 shadow-sm border-0 rounded-3">
                    <img src="@imageUrl" class="card-img-top" style="height: 180px; object-fit: cover;" alt="@item.FolderName" />
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">@item.FolderName</h5>
                        <p class="card-text text-muted">類別：@item.Category</p>
                        <a class="btn btn-outline-primary mt-auto" href="@previewUrl" target="_blank">前往預覽</a>
                    </div>
                </div>
            </div>
        }
    </div>
}
else
{
    <div class="alert alert-warning">目前沒有找到任何 index.html 模板。</div>
}
<div class="alert alert-info d-flex align-items-center justify-content-between p-4 rounded shadow-sm mb-5">
    <div>
        <h4 class="mb-1">網站模板總覽</h4>
        <p class="mb-0 text-muted">點我查看所有前台樣板，快速預覽選用！</p>
    </div>
    @* <a class="btn btn-primary" asp-controller="Home" asp-action="Templates">立即前往</a> Razor 寫法 *@
    <a class="btn btn-primary" href="/templates/showcase/public/index.html" target="_blank">立即前往</a>

</div>